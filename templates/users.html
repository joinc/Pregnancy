{% extends "base.html" %}{% load static %}
{% block html_title %}Управлние пользователями{% endblock %}
{% block html_head %}<link rel='stylesheet' href='{% static "css/main.css" %}' type='text/css' />{% endblock %}
{% block html_body %}
<div class="my-3 p-3 bg-white rounded shadow-sm">
    <div class="row">
        <div class="col-auto mr-auto">
            <h4 class="border-bottom border-gray pb-2 mb-0">Список пользователей:</h4>
        </div>
        <div class="col-auto mr-0 text-right">
            <button type="button" class="btn btn-outline-primary" data-toggle="modal" data-target="#ModalUserAdd" title="Добавить нового пользователя"><i class="fas fa-user-plus"></i></button>
            <div class="modal fade" id="ModalUserAdd" tabindex="-1" role="dialog" aria-labelledby="ModalUserAddTitle" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                    <div class="modal-content text-left">
                        <form method='post' action='{% url 'userlist' %}'>
                            <div class="modal-header">
                                <h4 class="modal-title" id="ModalDeleteTitle">Добавление нового пользователя</h4>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Закрыть">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="mb-3">
                                    {% for message in messages %}
                                        <div class="alert alert-danger" role="alert">{{ message }}</div>
                                    {% endfor %}
                                </div>
                                <div class="mb-3">
                                    <h6>{{ form_useradd.username.label }}:</h6>
                                    <div class="input-group">
                                        <div class="input-group-prepend"><span class="input-group-text">@</span></div>
                                        {{ form_useradd.username }}
                                    </div>
                                    <small class="form-text text-muted">Обязательное поле. Только английские буквы, цифры и символы @/./+/-/_.</small>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <h6>{{ form_useradd.last_name.label }}:</h6>
                                        {{ form_useradd.last_name }}
                                        <small class="form-text text-muted">Обязательное поле. На русском языке.</small>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <h6>{{ form_useradd.first_name.label }}:</h6>
                                        {{ form_useradd.first_name }}
                                        <small class="form-text text-muted">Обязательное поле. На русском языке.</small>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <h6>{{ form_useradd.role.label}}:</h6>
                                    {{ form_useradd.role }}
                                </div>
                                <div class="mb-3">
                                    <h6>{{ form_useradd.password.label}}:</h6>
                                    {{ form_useradd.password }}
                                    <small class="form-text text-muted">Пароль не должен совпадать с логином.<br />
                                    Пароль должен содержать как минимум 8 символов.<br />
                                    Пароль не должен состоять только из цифр.</small>
                                </div>
                                <div class="mb-3">
                                    <h6>{{ form_useradd.password2.label }}:</h6>
                                    {{ form_useradd.password2 }}
                                    <small class="form-text text-muted">Для подтверждения введите, пожалуйста, пароль ещё раз.</small>
                                </div>
                                {% csrf_token %}
                            </div>
                            <div class="modal-footer">
                                <button class="btn btn-success" type="submit">Добавить</button>
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Не добавлять</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% for u in userlist %}
        <div class="media text-muted pt-3">
            <svg class="bd-placeholder-img mr-2 rounded" width="32" height="32" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img" aria-label="Placeholder: 32x32"><title>Placeholder</title><rect width="100%" height="100%" fill="#007bff"></rect><text x="50%" y="50%" fill="#007bff" dy=".3em">32x32</text></svg>
            <div class="media-body pb-3 mb-0 small lh-125 border-bottom border-gray">
                <div class="d-flex justify-content-between align-items-center w-100">
                    <strong class="text-gray-dark">{{ u.user.get_full_name }}</strong>
                    {{ u.get_role_display }}
                    <a href="#">Заблокировать</a>
                </div>
                <span class="d-block">@{{ u.user.get_username }}</span>
            </div>
        </div>
    {% endfor %}
    <small class="d-block text-right mt-3">Всего пользователей: {{ usercount }}</small>
</div>
    {% if show_modal %}
        <script type="text/javascript">
            $(document).ready(function(){
                $('#ModalUserAdd').modal('show');
            });
        </script>
    {% endif %}
{% endblock %}
